<!-- /templates/{{ template }}.liquid -->

{% assign sold_out = true %}
{% assign on_sale = false %}
{% assign current_variant = product.selected_or_first_available_variant %}

{% if current_variant.compare_at_price > current_variant.price %}
  {% assign on_sale = true %}
{% endif %}

{% if current_variant.available %}
  {% assign sold_out = false %}
{% endif %}

<meta itemprop="url" content="{{ shop.url }}{{ product.url }}">
<meta itemprop="image" content="{{ product.featured_image | img_url: '1024x1024' }}">

<div class="Product">
  <div class="container l" itemscope itemtype="http://schema.org/Product" data-section-type="product" data-section-id="{{ section.id }}" data-enable-history-state="true">
    <meta itemprop="url" content="{{ shop.url }}{{ product.url }}">
    <meta itemprop="image" content="{{ product.featured_image | img_url: '1024x1024' }}">

    <div class="row flex h-space-between">
      <div class="column l8 m8 s12">
        {% include 'product-images' %}
        {% include 'product-description' %}
      </div>

      <div class="column l3 m3 s12">
        {% include 'product-form' %}
      </div>
      </div>
    </div>
  </div>
</div>
{% include 'size-finder' %}
<script>
// A simple example of image switching using the variantImageChange event and concrete's images tools.

$(document).on('variantImageChange', function(event) {
  // Lets get the old image
  var oldSrc = $('#ProductPhoto img').attr('src');
  // Find out the size of the old image
  var oldSize = concrete.Images.imageSize(oldSrc);
  // Lets get the new image at the correct size
  var newImage = concrete.Images.getImageUrl(event.variant.featured_image.src, oldSize)
  // Change to the new variants image
  $('#ProductPhoto img').attr('src', newImage);
});
</script>

<script type="application/json" id="ProductJson">
 {{ product | json }}
</script>
